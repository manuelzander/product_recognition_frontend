language: python
python:
  - 3.6

cache:
  directories:
    - ~/.npm
    - node_modules

before_install:
  - pip install requests
  - pip install PIL
  - nvm install 6.11
  - nvm use 6.11

# install dependencies
install:
  - pip install -r requirements/dev.txt
  - npm install

# this needs to be running before the tests are run
pre_script:
  - "echo 'Initiating flask app'"
  - directory_location.sh
  - sleep 5

script:
  - "export FLASK_APP=webcam-example/app.py"
  - "flask run"
  - "echo 'Running Integration tests'"
  - "cypress run --spec /cypress/integration/index_spec.js"
  - sleep 5 # give time to completely finish off

deploy:
  skip_cleanup: true